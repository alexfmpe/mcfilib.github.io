<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Philip is a Ruby and Haskell developer currently working remotely from Penarth.">
    <title>
      Philip Cunningham -
      
      List, Bag and Stack
      
    </title>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/filib.css">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="column one-third">
          <nav class="masthead">
            <ul>
              <li>
                <a href="../">
                  Home
                </a>
              </li>
              </li>
              <li>
                <a href="../about.html">
                  About
                </a>
              </li>
              <li>
                <a href="../rss.xml">
                  RSS
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
      <hr />
      <div class="row">
        <div>
  <h1>
    List, Bag and Stack
  </h1>
  <section>
    <header>
      <h2>
        2014-11-23
      </h2>
      <p>
        <a href="../tags/haskell.html" class="post-category green">haskell</a>
      </p>
    </header>

    <div>
      <div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">import</span> <span class="dt">Prelude</span> <span class="kw">hiding</span> (map, head, tail, length)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">-- Simple Linked List</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">data</span> <span class="dt">List</span> a <span class="fu">=</span> <span class="dt">Empty</span> <span class="fu">|</span> <span class="dt">Cons</span> a (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">head<span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">head (<span class="dt">Cons</span> x xs) <span class="fu">=</span> x</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">tail<span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">tail (<span class="dt">Cons</span> x xs) <span class="fu">=</span> xs</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="ot">cons ::</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> a</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">cons x xs <span class="fu">=</span> (<span class="dt">Cons</span> x xs)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">map<span class="ot"> ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">List</span> b</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">map _ <span class="dt">Empty</span>       <span class="fu">=</span> <span class="dt">Empty</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">map f (<span class="dt">Cons</span> x xs) <span class="fu">=</span> cons (f x) (map f xs)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20">length<span class="ot"> ::</span> <span class="dt">List</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">length <span class="dt">Empty</span>       <span class="fu">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">length (<span class="dt">Cons</span> x xs) <span class="fu">=</span> <span class="dv">1</span> <span class="fu">+</span> length xs</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">List</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  fmap <span class="fu">=</span> map</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">-- Simple Bag</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="kw">newtype</span> <span class="dt">Bag</span> a <span class="fu">=</span> <span class="dt">Bag</span> (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="ot">add ::</span> a <span class="ot">-&gt;</span> <span class="dt">Bag</span> a <span class="ot">-&gt;</span> <span class="dt">Bag</span> a</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">add x (<span class="dt">Bag</span> xs) <span class="fu">=</span> <span class="dt">Bag</span> (cons x xs)</a>
<a class="sourceLine" id="cb1-33" data-line-number="33"></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="ot">bagSize ::</span> <span class="dt">Bag</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35">bagSize (<span class="dt">Bag</span> xs) <span class="fu">=</span> length xs</a>
<a class="sourceLine" id="cb1-36" data-line-number="36"></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Bag</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38">  fmap f (<span class="dt">Bag</span> xs) <span class="fu">=</span> <span class="dt">Bag</span> (map f xs)</a>
<a class="sourceLine" id="cb1-39" data-line-number="39"></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">-- Simple Stack</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="kw">newtype</span> <span class="dt">Stack</span> a <span class="fu">=</span> <span class="dt">Stack</span> (<span class="dt">List</span> a) <span class="kw">deriving</span> <span class="dt">Show</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="ot">push ::</span> a <span class="ot">-&gt;</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> <span class="dt">Stack</span> a</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">push x (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="dt">Stack</span> (cons x xs)</a>
<a class="sourceLine" id="cb1-46" data-line-number="46"></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="ot">pop ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> (a, <span class="dt">Stack</span> a)</a>
<a class="sourceLine" id="cb1-48" data-line-number="48">pop (<span class="dt">Stack</span> xs) <span class="fu">=</span> ((head xs), <span class="dt">Stack</span> (tail xs))</a>
<a class="sourceLine" id="cb1-49" data-line-number="49"></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="ot">peek ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">peek (<span class="dt">Stack</span> xs) <span class="fu">=</span> head xs</a>
<a class="sourceLine" id="cb1-52" data-line-number="52"></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="ot">stackSize ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54">stackSize (<span class="dt">Stack</span> xs) <span class="fu">=</span> length xs</a>
<a class="sourceLine" id="cb1-55" data-line-number="55"></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Stack</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57">  fmap f (<span class="dt">Stack</span> xs) <span class="fu">=</span> <span class="dt">Stack</span> (map f xs)</a></code></pre></div>
    </div>
  </section>
</div>

      </div>
    </div>
  </body>
</html>
